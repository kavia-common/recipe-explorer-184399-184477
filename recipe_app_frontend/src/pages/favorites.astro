---
import Layout from "../layouts/Layout.astro";
import { getAllRecipes } from "../lib/api";
import { filterFavorites, getFavoriteIds } from "../lib/favorites";
import RecipeCard from "../components/RecipeCard.astro";

const all = await getAllRecipes();
const favs = filterFavorites(all);
const favIds = new Set(getFavoriteIds());
---
<Layout>
  <link rel="stylesheet" href="/src/styles/theme.css" />
  <nav class="topnav">
    <div class="topnav-inner">
      <a class="brand" href="/">
        <div class="brand-logo" aria-hidden="true"></div>
        <div class="brand-name">Recipe Explorer</div>
      </a>
      <div class="nav-actions">
        <a class="button ghost" href="/favorites" aria-current="page">Favorites</a>
      </div>
    </div>
  </nav>
  <div class="container">
    <h2 class="section-title">Your Favorites</h2>
    {favs.length === 0 ? (
      <div class="empty card">You haven't added any favorites yet.</div>
    ) : (
      <section class="grid recipes">
        {favs.map(r => <RecipeCard recipe={r} isFav={favIds.has(r.id)} />)}
      </section>
    )}
  </div>
</Layout>
